$(document).ready(function(){}),$(document).ready(function(){function t(t){t.button.hasClass("accordion--closed")?(a(t.button),e(t),ga("send","event",{eventCategory:t.label,eventAction:"open",eventLabel:userID}),s(t.label,"Opened")):(c(t.button),n(t),s(t.label,"Closed"))}function e(t){t.replaceButton===!0?t.button.html('<svg class="icon icon--close"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#close"></use></svg>'):t.closeLocation.append('<svg class="icon icon--close"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#close"></use></svg>')}function n(t){t.replaceButton===!0?t.button.html(t.content):t.closeLocation.children().remove()}function o(t){var e=t.button[0].getBoundingClientRect().top;-20<e&&e<100||scrollBy(0,e-10)}function c(t){t.addClass("accordion--closed"),t.removeClass("accordion--open")}function a(t){t.removeClass("accordion--closed"),t.addClass("accordion--open")}function l(t,e,n){var o=new XMLHttpRequest;o.open("POST","../../inc/class.log.php"),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.onload=function(){200===o.status||200!==o.status&&alert("Request failed.  Returned status of "+o.status)},o.send(encodeURI("log=true&user_id="+userID+"&action="+t+"&comment="+n+"&label="+e+"&url="+window.location.href))}function s(t,e){l("click",t,e)}function r(t,e,n,o){new Date;$(".new-comment").replaceWith('<div class="alert alert-success">Thanks for your comment!</div>'),l("Comment","Add Comment",t+": "+e),$.ajax({type:"POST",url:"../../inc/log-comment.php",dataType:"json",data:{comment:e,name:t,identifier:n,url:o}})}function i(){$(".alert-error").remove(),$(".new-comment").append("<div class='alert alert-error'>* Please enter your name and a comment.</div>"),l("Comment","Add Comment","Add Comment Error")}function u(t,e){newComment=$(".comment:eq(0)").clone(),newComment.find(".comment-name").text(t),newComment.find(".comment-time").text("Now"),e=e.replace(/(?:\r\n|\r|\n)/g,"<br />"),newComment.find(".comment-content").html(e),newComment.hide().appendTo(".comments").fadeIn()}var d=["footnote","category","author"];$(".category__type").after('<button class="category__button">Learn More</button>'),$(".category__content").append('<button class="category__second-close accordion__second-close"><svg class="icon icon--close"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#close"></use></svg> Close Section</button>'),$(".author__content").before('<button id="authorBtn" class="author__button">Read Bio</button>'),$(".author__content").append('<button class="author__second-close accordion__second-close"><svg class="icon icon--close"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#close"></use></svg> Close Section</button>');for(var m=0;m<d.length;m++)$("."+d[m]+"__button").length&&($("."+d[m]+"__button").addClass("accordion--closed").addClass("accordion__button"),$("."+d[m]+"__content").addClass("accordion__content"));var _={button:$(".author__button"),label:"Author Bio",replaceButton:!0,closeLocation:$(".author__button"),content:"Read Bio"};$(".author__button").data("btn",_),$(".author__second-close").data("btn",_);var p={button:$(".category__button"),label:"Article Type",replaceButton:!0,closeLocation:$(".category__button"),content:"Learn More"};$(".category__button").data("btn",p),$(".category__second-close").data("btn",p);var b={button:"",replaceButton:!0,closeLocation:"",content:""};$(document).on("click","a",function(t){t.preventDefault(),url=$(this).attr("href"),linkText=$.trim($(this).text()),linkText=linkText.replace(/\r?\n|\r/g," "),linkText=linkText.replace(/\s\s\s/g,""),s("Link: "+linkText,url),window.location.href=url}),$(".footnote__button").each(function(t){var e=$(this).data("footnote-id");b={button:$(this),label:"Footnote "+e,replaceButton:!0,content:"<sup>"+e+"</sup>",closeLocation:$(this)},$(this).data("btn",b)}),$(document).on("click",".accordion__button",function(e){e.preventDefault(),t($(this).data("btn"))}),$(document).on("click",".accordion__second-close",function(e){e.preventDefault();var n=$(this).data("btn");t(n),o(n)}),l("Page View",pageTitle,"Loaded"),$("#submit-comment").click(function(t){var e=$("#commenter-name").val(),n=$("#commenter-comment").val(),o=(pageTitle,userID);e.length>0&&n.length>0?(r(e,n,o),u(e,n),ga("send","event","Comments","Add Comment",o)):(i(),ga("send","event","Comments","Add Comment Error",o)),t.preventDefault()})});